#include "./M/M___future__.c"
#include "./M/M___main__.c"
#include "./M/M__bootlocale.c"
#include "./M/M__collections_abc.c"
#include "./M/M__compat_pickle.c"
#include "./M/M__compression.c"
#include "./M/M__frozen_importlib.c"
#include "./M/M__frozen_importlib_external.c"
#include "./M/M__py_abc.c"
#include "./M/M__sitebuiltins.c"
#include "./M/M__strptime.c"
#include "./M/M__threading_local.c"
#include "./M/M__weakrefset.c"
#include "./M/M_abc.c"
#include "./M/M_argparse.c"
#include "./M/M_ast.c"
#include "./M/M_base64.c"
#include "./M/M_bdb.c"
#include "./M/M_bisect.c"
#include "./M/M_bz2.c"
#include "./M/M_calendar.c"
#include "./M/M_cmd.c"
#include "./M/M_code.c"
#include "./M/M_codecs.c"
#include "./M/M_codeop.c"
#include "./M/M_collections.c"
#include "./M/M_collections__abc.c"
#include "./M/M_contextlib.c"
#include "./M/M_copy.c"
#include "./M/M_copyreg.c"
#include "./M/M_datetime.c"
#include "./M/M_difflib.c"
#include "./M/M_dis.c"
#include "./M/M_doctest.c"
#include "./M/M_email.c"
#include "./M/M_email___encoded_words.c"
#include "./M/M_email___header_value_parser.c"
#include "./M/M_email___parseaddr.c"
#include "./M/M_email___policybase.c"
#include "./M/M_email__base64mime.c"
#include "./M/M_email__charset.c"
#include "./M/M_email__contentmanager.c"
#include "./M/M_email__encoders.c"
#include "./M/M_email__errors.c"
#include "./M/M_email__feedparser.c"
#include "./M/M_email__generator.c"
#include "./M/M_email__header.c"
#include "./M/M_email__headerregistry.c"
#include "./M/M_email__iterators.c"
#include "./M/M_email__message.c"
#include "./M/M_email__parser.c"
#include "./M/M_email__policy.c"
#include "./M/M_email__quoprimime.c"
#include "./M/M_email__utils.c"
#include "./M/M_encodings.c"
#include "./M/M_encodings__aliases.c"
#include "./M/M_encodings__latin_1.c"
#include "./M/M_encodings__mbcs.c"
#include "./M/M_encodings__utf_8.c"
#include "./M/M_encodings__ascii.c"
#include "./M/M_enum.c"
#include "./M/M_fnmatch.c"
#include "./M/M_functools.c"
#include "./M/M_genericpath.c"
#include "./M/M_getopt.c"
#include "./M/M_gettext.c"
#include "./M/M_glob.c"
#include "./M/M_gzip.c"
#include "./M/M_hashlib.c"
#include "./M/M_heapq.c"
#include "./M/M_html.c"
#include "./M/M_html__entities.c"
#include "./M/M_http.c"
#include "./M/M_http__client.c"
#include "./M/M_http__server.c"
#include "./M/M_importlib.c"
#include "./M/M_importlib___bootstrap.c"
#include "./M/M_importlib___bootstrap_external.c"
#include "./M/M_importlib__abc.c"
#include "./M/M_importlib__machinery.c"
#include "./M/M_importlib__util.c"
#include "./M/M_inspect.c"
#include "./M/M_io.c"
#include "./M/M_json.c"
#include "./M/M_json__decoder.c"
#include "./M/M_json__encoder.c"
#include "./M/M_json__scanner.c"
#include "./M/M_keyword.c"
#include "./M/M_linecache.c"
#include "./M/M_locale.c"
#include "./M/M_logging.c"
#include "./M/M_lzma.c"
#include "./M/M_mimetypes.c"
#include "./M/M_ntpath.c"
#include "./M/M_opcode.c"
#include "./M/M_operator.c"
#include "./M/M_optparse.c"
#include "./M/M_os.c"
#include "./M/M_pdb.c"
#include "./M/M_pickle.c"
#include "./M/M_pkgutil.c"
#include "./M/M_platform.c"
#include "./M/M_plistlib.c"
#include "./M/M_posixpath.c"
#include "./M/M_pprint.c"
#include "./M/M_py_compile.c"
#include "./M/M_pydoc.c"
#include "./M/M_pydoc_data.c"
#include "./M/M_pydoc_data__topics.c"
#include "./M/M_quopri.c"
#include "./M/M_random.c"
#include "./M/M_re.c"
#include "./M/M_reprlib.c"
#include "./M/M_rlcompleter.c"
#include "./M/M_runpy.c"
#include "./M/M_selectors.c"
#include "./M/M_shlex.c"
#include "./M/M_shutil.c"
#include "./M/M_signal.c"
#include "./M/M_site.c"
#include "./M/M_socket.c"
#include "./M/M_socketserver.c"
#include "./M/M_sre_compile.c"
#include "./M/M_sre_constants.c"
#include "./M/M_sre_parse.c"
#include "./M/M_ssl.c"
#include "./M/M_stat.c"
#include "./M/M_string.c"
#include "./M/M_struct.c"
#include "./M/M_subprocess.c"
#include "./M/M_tarfile.c"
#include "./M/M_tempfile.c"
#include "./M/M_textwrap.c"
#include "./M/M_threading.c"
#include "./M/M_token.c"
#include "./M/M_tokenize.c"
#include "./M/M_traceback.c"
#include "./M/M_tracemalloc.c"
#include "./M/M_tty.c"
#include "./M/M_types.c"
#include "./M/M_typing.c"
#include "./M/M_unittest.c"
#include "./M/M_unittest__case.c"
#include "./M/M_unittest__loader.c"
#include "./M/M_unittest__main.c"
#include "./M/M_unittest__result.c"
#include "./M/M_unittest__runner.c"
#include "./M/M_unittest__signals.c"
#include "./M/M_unittest__suite.c"
#include "./M/M_unittest__util.c"
#include "./M/M_urllib.c"
#include "./M/M_urllib__parse.c"
#include "./M/M_uu.c"
#include "./M/M_warnings.c"
#include "./M/M_weakref.c"
#include "./M/M_webbrowser.c"
#include "./M/M_xml.c"
#include "./M/M_xml__parsers.c"
#include "./M/M_xml__parsers__expat.c"
#include "./M/M_zipfile.c"
#include "./M/M_base58.c"
#include "./M/M_db.c"

#include "Python.h"

static unsigned char M___hello__[] = {
    227,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,
    0,64,0,0,0,115,16,0,0,0,100,0,90,0,101,1,
    100,1,131,1,1,0,100,2,83,0,41,3,84,122,12,72,
    101,108,108,111,32,119,111,114,108,100,33,78,41,2,218,11,
    105,110,105,116,105,97,108,105,122,101,100,218,5,112,114,105,
    110,116,169,0,114,3,0,0,0,114,3,0,0,0,250,22,
    46,47,84,111,111,108,115,47,102,114,101,101,122,101,47,102,
    108,97,103,46,112,121,218,8,60,109,111,100,117,108,101,62,
    1,0,0,0,115,2,0,0,0,4,1,
};

#define SIZE (int)sizeof(M___hello__)

static struct _frozen _PyImport_FrozenModules[] = {
    {"__hello__",           M___hello__,        SIZE},
	{"__future__", M___future__, 4135},
	{"__main__", M___main__, 269},
	{"_bootlocale", M__bootlocale, 1252},
	{"_collections_abc", M__collections_abc, 28945},
	{"_compat_pickle", M__compat_pickle, 5811},
	{"_compression", M__compression, 4127},
	{"_frozen_importlib", M__frozen_importlib, 29187},
	{"_frozen_importlib_external", M__frozen_importlib_external, 41821},
	{"_py_abc", M__py_abc, 4657},
	{"_sitebuiltins", M__sitebuiltins, 3468},
	{"_strptime", M__strptime, 16107},
	{"_threading_local", M__threading_local, 6415},
	{"_weakrefset", M__weakrefset, 7465},
	{"abc", M_abc, 6454},
	{"argparse", M_argparse, 61916},
	{"ast", M_ast, 12083},
	{"base64", M_base64, 16991},
	{"bdb", M_bdb, 24397},
	{"bisect", M_bisect, 2701},
	{"bz2", M_bz2, 11184},
	{"calendar", M_calendar, 27427},
	{"cmd", M_cmd, 12593},
	{"code", M_code, 9861},
	{"codecs", M_codecs, 33901},
	{"codeop", M_codeop, 6293},
	{"collections", M_collections, -46613},
	{"collections.abc", M_collections__abc, 208},
	{"contextlib", M_contextlib, 19903},
	{"copy", M_copy, 7104},
	{"copyreg", M_copyreg, 4247},
	{"datetime", M_datetime, 57252},
	{"difflib", M_difflib, 59441},
#if 0
	{"dis", M_dis, 15208},
	{"doctest", M_doctest, 75613},
	{"email", M_email, -1694},
	{"email._encoded_words", M_email___encoded_words, 5611},
	{"email._header_value_parser", M_email___header_value_parser, 75633},
	{"email._parseaddr", M_email___parseaddr, 12351},
	{"email._policybase", M_email___policybase, 14853},
	{"email.base64mime", M_email__base64mime, 3238},
	{"email.charset", M_email__charset, 11532},
	{"email.contentmanager", M_email__contentmanager, 7298},
	{"email.encoders", M_email__encoders, 1667},
	{"email.errors", M_email__errors, 6194},
	{"email.feedparser", M_email__feedparser, 10628},
	{"email.generator", M_email__generator, 12503},
	{"email.header", M_email__header, 16383},
	{"email.headerregistry", M_email__headerregistry, 21300},
	{"email.iterators", M_email__iterators, 1935},
	{"email.message", M_email__message, 37943},
	{"email.parser", M_email__parser, 5750},
	{"email.policy", M_email__policy, 9643},
	{"email.quoprimime", M_email__quoprimime, 7667},
	{"email.utils", M_email__utils, 9470},
#endif
	{"encodings", M_encodings, -3950},
	{"encodings.aliases", M_encodings__aliases, 6299},
	{"encodings.latin_1", M_encodings__latin_1, 1899},
	{"encodings.mbcs", M_encodings__mbcs, 1698},
	{"encodings.utf_8", M_encodings__utf_8, 1617},
	{"enum", M_enum, 24265},
	{"fnmatch", M_fnmatch, 3340},
	{"functools", M_functools, 23952},
	{"genericpath", M_genericpath, 3751},
	{"getopt", M_getopt, 6242},
	{"gettext", M_gettext, 14171},
	{"glob", M_glob, 4262},
	{"gzip", M_gzip, 17188},
	{"hashlib", M_hashlib, 6594},
	{"heapq", M_heapq, 14365},
	{"html", M_html, -3400},
	{"html.entities", M_html__entities, 50472},
	{"http", M_http, -5925},
	{"http.client", M_http__client, 34051},
	{"http.server", M_http__server, 33370},
	{"importlib", M_importlib, -3735},
	{"importlib._bootstrap", M_importlib___bootstrap, 29187},
	{"importlib._bootstrap_external", M_importlib___bootstrap_external, 41821},
	{"importlib.abc", M_importlib__abc, 13490},
	{"importlib.machinery", M_importlib__machinery, 975},
	{"importlib.util", M_importlib__util, 9359},
	{"inspect", M_inspect, 80035},
	{"io", M_io, 3412},
	{"json", M_json, -12341},
	{"json.decoder", M_json__decoder, 9827},
	{"json.encoder", M_json__encoder, 11309},
	{"json.scanner", M_json__scanner, 1999},
	{"keyword", M_keyword, 1812},
	{"linecache", M_linecache, 3792},
	{"locale", M_locale, 34558},
	{"logging", M_logging, -62561},
	{"lzma", M_lzma, 11942},
	{"mimetypes", M_mimetypes, 15481},
	{"ntpath", M_ntpath, 13007},
	{"opcode", M_opcode, 5381},
	{"operator", M_operator, 13903},
	{"optparse", M_optparse, 47896},
	{"os", M_os, 29696},
	{"pdb", M_pdb, 46765},
	{"pickle", M_pickle, 42969},
	{"pkgutil", M_pkgutil, 16363},
	{"platform", M_platform, 28223},
	{"plistlib", M_plistlib, 25098},
	{"posixpath", M_posixpath, 10433},
	{"pprint", M_pprint, 15822},
	{"py_compile", M_py_compile, 7194},
	{"pydoc", M_pydoc, 84423},
	{"pydoc_data", M_pydoc_data, -149},
	{"pydoc_data.topics", M_pydoc_data__topics, 411337},
	{"quopri", M_quopri, 5774},
	{"random", M_random, 19397},
	{"re", M_re, 13807},
	{"reprlib", M_reprlib, 5353},
	{"rlcompleter", M_rlcompleter, 5750},
	{"runpy", M_runpy, 7948},
	{"selectors", M_selectors, 16951},
	{"shlex", M_shlex, 6993},
	{"shutil", M_shutil, 30867},
	{"signal", M_signal, 2515},
	{"site", M_site, 16529},
	{"socket", M_socket, 22024},
	{"socketserver", M_socketserver, 24201},
	{"sre_compile", M_sre_compile, 15206},
	{"sre_constants", M_sre_constants, 6294},
	{"sre_parse", M_sre_parse, 21360},
	{"ssl", M_ssl, 39774},
	{"stat", M_stat, 3876},
	{"string", M_string, 7838},
	{"struct", M_struct, 337},
	{"subprocess", M_subprocess, 38768},
	{"tarfile", M_tarfile, 61844},
	{"tempfile", M_tempfile, 22148},
	{"textwrap", M_textwrap, 13615},
	{"threading", M_threading, 37338},
	{"token", M_token, 3602},
	{"tokenize", M_tokenize, 17834},
	{"traceback", M_traceback, 19626},
	{"tracemalloc", M_tracemalloc, 17279},
	{"tty", M_tty, 1097},
	{"types", M_types, 8977},
	{"typing", M_typing, 49961},
	{"unittest", M_unittest, -3014},
	{"unittest.case", M_unittest__case, 48086},
	{"unittest.loader", M_unittest__loader, 14272},
	{"unittest.main", M_unittest__main, 7441},
	{"unittest.result", M_unittest__result, 7255},
	{"unittest.runner", M_unittest__runner, 6984},
	{"unittest.signals", M_unittest__signals, 2197},
	{"unittest.suite", M_unittest__suite, 9206},
	{"unittest.util", M_unittest__util, 4524},
	{"urllib", M_urllib, -145},
	{"urllib.parse", M_urllib__parse, 30022},
	{"uu", M_uu, 3616},
	{"warnings", M_warnings, 13952},
	{"weakref", M_weakref, 19113},
	{"webbrowser", M_webbrowser, 16377},
	{"xml", M_xml, -709},
	{"xml.parsers", M_xml__parsers, -322},
	{"xml.parsers.expat", M_xml__parsers__expat, 351},
	{"zipfile", M_zipfile, 49875},

    {0, 0, 0} /* sentinel */
};


const struct _frozen *PyImport_FrozenModules = _PyImport_FrozenModules;

static struct _frozen _PyImport_FrozenModules_for_pythonvm[] = {
	{"__future__",          M___future__, (int)sizeof(M___future__)},
	{"codecs",              M_codecs,           (int)sizeof(M_codecs)},
	{"encodings",           M_encodings, -(int)sizeof(M_encodings)},
	{"encodings.aliases",   M_encodings__aliases, (int)sizeof(M_encodings__aliases)},
	{"encodings.latin_1",   M_encodings__latin_1, (int)sizeof(M_encodings__latin_1)},
	{"encodings.mbcs",      M_encodings__mbcs, (int)sizeof(M_encodings__mbcs)},
	{"encodings.utf_8",     M_encodings__utf_8, (int)sizeof(M_encodings__utf_8)},
	{"encodings.ascii",     M_encodings__ascii, (int)sizeof(M_encodings__ascii)},

    /* importlib */
    {"_frozen_importlib",   M__frozen_importlib, (int)sizeof(M__frozen_importlib)},
    {"_frozen_importlib_external", M__frozen_importlib_external, (int)sizeof(M__frozen_importlib_external)},
//
	{"io",                  M_io,               (int)sizeof(M_io)},
	{"struct",              M_struct,           (int)sizeof(M_struct)},
	{"abc",                 M_abc,              (int)sizeof(M_abc)},
	{"pickle",              M_pickle,           (int)sizeof(M_pickle)},
#if 0
	{"json",                M_json,             -(int)sizeof(M_json)},
	{"json.decoder",        M_json__decoder,    (int)sizeof(M_json__decoder)},
	{"json.encoder",        M_json__encoder,    (int)sizeof(M_json__encoder)},
	{"json.scanner",        M_json__scanner,    (int)sizeof(M_json__scanner)},
#endif
	{"db",     M_db, (int)sizeof(M_db)},
	{"base58", M_base58, (int)sizeof(M_base58)},
//	{"base64", M_base64, sizeof(M_base64)},
    /* Test module */
    {"__hello__",           M___hello__,        SIZE},
	{"hashlib",             M_hashlib,          sizeof(M_hashlib)},
    /* Test package (negative size indicates package-ness) */
    {"__phello__",          M___hello__,        -SIZE},
    {"__phello__.spam",     M___hello__,        SIZE},
    {0, 0, 0} /* sentinel */
};


void find_frozen_code(const char *name, const char **code, int *size)
{
	printf("++++find_frozen_code %s\n", name);
    const struct _frozen *p;
    if (name == NULL) {
        *size = 0;
        return;
    }

    for (p = _PyImport_FrozenModules_for_pythonvm; ; p++) {
        if (p->name == NULL) {
            *size = 0;
            return;
        }
		printf("++++find_frozen_code p->name %s\n", p->name);
        if (strcmp(name, p->name) == 0) {
            break;
        }
    }
    *code = (const char *)p->code;
    *size = p->size;
}

#if 0
int init_frozen_module() {
//    PyImport_FrozenModules = _PyImport_FrozenModules;
}

int run_python(int argc, char **argv)
{
        extern int Py_FrozenMain(int, char **);

        PyImport_FrozenModules = _PyImport_FrozenModules;
        return Py_FrozenMain(argc, argv);
}

#endif